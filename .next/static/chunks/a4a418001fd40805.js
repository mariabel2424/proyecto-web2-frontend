(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,14867,e=>{"use strict";var a=e.i(96564),t=e.i(55528);e.s(["facturasService",0,{async getAll(e){let{data:r}=await a.apiClient.get(t.API_ENDPOINTS.facturas,e);if(r&&"object"==typeof r&&"success"in r&&r.data){let e=r.data;return Array.isArray(e)?{data:e,total:e.length,current_page:1,last_page:1,per_page:e.length,from:1,to:e.length}:e}return Array.isArray(r)?{data:r,total:r.length,current_page:1,last_page:1,per_page:r.length,from:1,to:r.length}:r},async getById(e){let{data:r}=await a.apiClient.get(`${t.API_ENDPOINTS.facturas}/${e}`);return r},async create(e){let{data:r}=await a.apiClient.post(t.API_ENDPOINTS.facturas,e);return r},async update(e,r){let{data:s}=await a.apiClient.put(`${t.API_ENDPOINTS.facturas}/${e}`,r);return s},async delete(e){await a.apiClient.delete(`${t.API_ENDPOINTS.facturas}/${e}`)},async cambiarEstado(e,r){let{data:s}=await a.apiClient.put(`${t.API_ENDPOINTS.facturas}/${e}`,{estado:r});return s},async registrarPago(e,r){let{data:s}=await a.apiClient.post(`${t.API_ENDPOINTS.facturas}/${e}/registrar-pago`,r);return s},async generarDesdeInscripcion(e,r){let{data:s}=await a.apiClient.post(`${t.API_ENDPOINTS.facturas}/generar-desde-inscripcion/${e}`,{id_tutor:r});return s},async getFacturasPorTutor(e){let{data:r}=await a.apiClient.get(`${t.API_ENDPOINTS.facturas}/tutor/${e}`);return r},async getReporteFacturacion(e){let{data:r}=await a.apiClient.get(`${t.API_ENDPOINTS.facturas}/reporte/facturacion`,e);return r},async getDatosParaPdf(e){let{data:r}=await a.apiClient.get(`${t.API_ENDPOINTS.facturas}/${e}/pdf`);return r}},"pagosService",0,{async getAll(e){let{data:r}=await a.apiClient.get(t.API_ENDPOINTS.pagos,e);if(r&&"object"==typeof r&&"success"in r&&r.data){let e=r.data;return Array.isArray(e)?{data:e,total:e.length,current_page:1,last_page:1,per_page:e.length,from:1,to:e.length}:e}return Array.isArray(r)?{data:r,total:r.length,current_page:1,last_page:1,per_page:r.length,from:1,to:r.length}:r},async getById(e){let{data:r}=await a.apiClient.get(`${t.API_ENDPOINTS.pagos}/${e}`);return r},async update(e,r){let{data:s}=await a.apiClient.put(`${t.API_ENDPOINTS.pagos}/${e}`,r);return s},async delete(e){await a.apiClient.delete(`${t.API_ENDPOINTS.pagos}/${e}`)},async verificar(e){let{data:r}=await a.apiClient.post(`${t.API_ENDPOINTS.pagos}/${e}/verificar`);return r},async rechazar(e,r){let{data:s}=await a.apiClient.post(`${t.API_ENDPOINTS.pagos}/${e}/rechazar`,{motivo:r});return s}}])},21419,e=>{"use strict";var a=e.i(44472),t=e.i(30680),r=e.i(96833);e.i(51766);var s=e.i(5174);e.i(36106);var n=e.i(75650),i=e.i(75227),o=e.i(13762),l=e.i(80028),c=e.i(14867);function u(){let e=(0,r.useRouter)(),u=Number((0,r.useParams)().id),[d,p]=(0,t.useState)(!1),[g,f]=(0,t.useState)(!0),[m,y]=(0,t.useState)(""),[h,N]=(0,t.useState)(null),[b,P]=(0,t.useState)({monto:"",metodo_pago:"efectivo",referencia:"",observaciones:""});(0,t.useEffect)(()=>{(async()=>{try{let e=await c.facturasService.getById(u);N(e),P(a=>({...a,monto:String(e.total)}))}catch(e){y("Error al cargar la factura"),console.error(e)}finally{f(!1)}})()},[u]);let I=e=>{let{name:a,value:t}=e.target;P(e=>({...e,[a]:t}))},v=async a=>{a.preventDefault(),p(!0),y("");try{await c.facturasService.registrarPago(u,{monto:parseFloat(b.monto),metodo_pago:b.metodo_pago,referencia:b.referencia||void 0,observaciones:b.observaciones||void 0,fecha_pago:new Date().toISOString().split("T")[0]}),e.push("/finanzas/facturas")}catch(e){y(e instanceof Error?e.message:"Error al registrar el pago")}finally{p(!1)}};return g?(0,a.jsx)(s.DashboardLayout,{children:(0,a.jsx)("div",{className:"flex justify-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):(0,a.jsx)(s.DashboardLayout,{children:(0,a.jsx)("div",{className:"max-w-lg mx-auto",children:(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsx)(n.CardTitle,{children:"Registrar Pago"})}),(0,a.jsxs)(n.CardContent,{children:[h&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Factura: ",h.numero_factura]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Concepto: ",h.concepto]}),(0,a.jsxs)("p",{className:"text-lg font-bold mt-2",children:["Total a pagar: $",h.total.toFixed(2)]})]}),m&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:m}),(0,a.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,a.jsx)(o.Input,{label:"Monto ($)",name:"monto",type:"number",step:"0.01",value:b.monto,onChange:I,required:!0}),(0,a.jsx)(l.Select,{label:"Método de Pago",name:"metodo_pago",value:b.metodo_pago,onChange:I,options:[{value:"efectivo",label:"Efectivo"},{value:"transferencia",label:"Transferencia"},{value:"tarjeta",label:"Tarjeta"},{value:"otro",label:"Otro"}]}),(0,a.jsx)(o.Input,{label:"Referencia / Comprobante",name:"referencia",value:b.referencia,onChange:I,placeholder:"Número de transacción, etc."}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observaciones"}),(0,a.jsx)("textarea",{name:"observaciones",value:b.observaciones,onChange:I,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,a.jsx)(i.Button,{type:"button",variant:"secondary",onClick:()=>e.back(),children:"Cancelar"}),(0,a.jsx)(i.Button,{type:"submit",disabled:d,children:d?"Procesando...":"Registrar Pago"})]})]})]})]})})})}e.s(["default",()=>u])}]);