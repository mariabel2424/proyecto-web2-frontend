module.exports=[96416,a=>{"use strict";var b=a.i(57692),c=a.i(98620),d=a.i(28632);a.i(67360);var e=a.i(4656);a.i(95994);var f=a.i(36119),g=a.i(77314),h=a.i(91363),i=a.i(63953),j=a.i(2133),k=a.i(60364),l=a.i(21248),m=a.i(87728),n=a.i(86993),o=a.i(33093),p=a.i(29869),q=a.i(3040),r=a.i(65772);let s=c.forwardRef(function({title:a,titleId:b,...d},e){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":b},d),a?c.createElement("title",{id:b},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}),t=process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME,u=process.env.NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET;async function v(a,b="comprobantes"){if(!t||!u)throw Error("Cloudinary no está configurado correctamente");let c=new FormData;c.append("file",a),c.append("upload_preset",u),c.append("folder",b);try{let a=await fetch(`https://api.cloudinary.com/v1_1/${t}/image/upload`,{method:"POST",body:c});if(!a.ok)throw Error("Error al subir la imagen");return await a.json()}catch(a){throw console.error("Error uploading to Cloudinary:",a),Error("No se pudo subir la imagen. Intenta nuevamente.")}}function w(){let a=(0,d.useRouter)(),t=(0,d.useSearchParams)(),[u,w]=(0,c.useState)("participante"),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)([]),[H,I]=(0,c.useState)([]),[J,K]=(0,c.useState)([]),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(1),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)(1),[T,U]=(0,c.useState)(null),[V,W]=(0,c.useState)(null),[X,Y]=(0,c.useState)(null),[Z,$]=(0,c.useState)({metodo_pago:"transferencia",referencia:"",observaciones:""}),[_,aa]=(0,c.useState)(null),[ab,ac]=(0,c.useState)(""),[ad,ae]=(0,c.useState)(!1),af=a=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD"}).format(a),ag=a=>new Date(a).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"}),ah=a=>{if(!a)return"";let[b,c]=a.split(":"),d=parseInt(b);return`${d%12||12}:${c} ${d>=12?"PM":"AM"}`},ai=(0,c.useCallback)(async()=>{try{y(!0);let[a,b]=await Promise.all([m.deportistasService.getMisParticipantes(),l.cursosService.getCursosAbiertos()]);G(Array.isArray(a)?a:[]),I(b||[]);let c=t.get("curso");if(c){let a=parseInt(c);W(a);let b=await l.cursosService.getGruposPublico(a);K(b||[]);let d=t.get("grupo");d&&Y(parseInt(d))}}catch{C("Error al cargar datos")}finally{y(!1)}},[t]);(0,c.useEffect)(()=>{ai()},[ai]);let aj=async a=>{W(a),Y(null),S(1),M(!0);try{let b=await l.cursosService.getGruposPublico(a);K(b||[])}catch{K([])}finally{M(!1)}},ak=async()=>{if(!T||!V||!X)return void C("Completa todos los campos");if(("transferencia"===Z.metodo_pago||"efectivo"===Z.metodo_pago)&&!_)return void C("Debes subir un comprobante de pago");A(!0),C("");try{let a="";_&&(ae(!0),a=(await v(_,"comprobantes")).secure_url,ae(!1)),await l.inscripcionesService.create({id_curso:V,id_grupo:X,id_deportista:T,generar_factura:!0,observaciones:`${Z.observaciones||""} - M\xe9todo: ${Z.metodo_pago} - Ref: ${Z.referencia||"N/A"}${a?` - Comprobante: ${a}`:""}`}),E("¡Inscripción realizada! El administrador verificará tu pago."),w("confirmacion")}catch(a){C(a.message||"Error al inscribir")}finally{A(!1),ae(!1)}},al=H.filter(a=>a.nombre.toLowerCase().includes(P.toLowerCase())),am=Math.ceil(al.length/6),an=al.slice((N-1)*6,6*N),ao=Math.ceil(J.length/4),ap=J.slice((R-1)*4,4*R),aq=F.find(a=>a.id_deportista===T),ar=H.find(a=>a.id_curso===V),as=J.find(a=>a.id_grupo===X);return(0,b.jsx)(e.DashboardLayout,{children:(0,b.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-green-50 rounded-lg",children:(0,b.jsx)(n.AcademicCapIcon,{className:"h-5 w-5 text-green-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-lg font-semibold",children:"Inscribir en Curso"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Inscribe a tu hijo en un curso vacacional"})]})]}),B&&(0,b.jsx)(h.Alert,{variant:"error",onClose:()=>C(""),children:B}),D&&(0,b.jsx)(h.Alert,{variant:"success",onClose:()=>E(""),children:D}),(0,b.jsx)("div",{className:"flex items-center justify-between px-2",children:["participante","curso","pago","confirmacion"].map((a,c)=>{let d=a===u,e="participante"===a&&T||"curso"===a&&X||"pago"===a&&"confirmacion"===u;return(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${d?"bg-green-600 text-white":e?"bg-green-500 text-white":"bg-gray-200"}`,children:e&&!d?(0,b.jsx)(o.CheckCircleIcon,{className:"h-5 w-5"}):c+1}),(0,b.jsx)("span",{className:`ml-2 text-sm ${d?"text-green-600 font-medium":"text-gray-500"}`,children:["Participante","Curso","Pago","Confirmación"][c]}),c<3&&(0,b.jsx)("div",{className:"w-8 h-0.5 mx-2 bg-gray-200"})]},a)})}),(0,b.jsxs)(f.Card,{className:"p-6",children:["participante"===u&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h2",{className:"font-medium",children:"¿A quién deseas inscribir?"}),(0,b.jsx)("div",{className:"space-y-2",children:F.map(a=>(0,b.jsx)("button",{onClick:()=>U(a.id_deportista),className:`w-full p-4 text-left border rounded-lg ${T===a.id_deportista?"border-green-600 bg-green-50":"border-gray-200 hover:border-green-300"}`,children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"font-medium",children:[a.nombres," ",a.apellidos]}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:a.categoria?.nombre||"Sin categoría"})]}),T===a.id_deportista&&(0,b.jsx)(o.CheckCircleIcon,{className:"h-6 w-6 text-green-600"})]})},a.id_deportista))}),(0,b.jsx)("div",{className:"flex justify-end pt-4",children:(0,b.jsx)(g.Button,{onClick:()=>w("curso"),disabled:!T,children:"Continuar"})})]}),"curso"===u&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h2",{className:"font-medium",children:"Selecciona el curso y horario"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(p.MagnifyingGlassIcon,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Buscar curso...",value:P,onChange:a=>{Q(a.target.value),O(1)},className:"w-full pl-10 pr-10 py-2.5 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"}),P&&(0,b.jsx)("button",{onClick:()=>Q(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,b.jsx)(q.XMarkIcon,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]}),x?(0,b.jsx)("div",{className:"flex justify-center py-8",children:(0,b.jsx)(i.Spinner,{})}):0===an.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:P?"No se encontraron cursos con ese nombre":"No hay cursos disponibles"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"space-y-2",children:an.map(a=>(0,b.jsx)("button",{onClick:()=>aj(a.id_curso),className:`w-full p-4 text-left border rounded-lg transition-all ${V===a.id_curso?"border-green-600 bg-green-50 shadow-sm":"border-gray-200 hover:border-green-300 hover:shadow-sm"}`,children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"font-medium",children:a.nombre}),(0,b.jsx)("span",{className:`text-xs px-2 py-0.5 rounded ${"vacacional"===a.tipo?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:a.tipo})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[ag(a.fecha_inicio)," -"," ",ag(a.fecha_fin)]}),a.descripcion&&(0,b.jsx)("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:a.descripcion})]}),(0,b.jsxs)("div",{className:"text-right ml-4",children:[(0,b.jsx)("p",{className:"font-semibold text-green-600 text-lg",children:af(a.precio||0)}),V===a.id_curso&&(0,b.jsx)(o.CheckCircleIcon,{className:"h-6 w-6 text-green-600 mt-1 ml-auto"})]})]})},a.id_curso))}),am>1&&(0,b.jsx)("div",{className:"flex justify-center pt-2",children:(0,b.jsx)(k.Pagination,{page:N,lastPage:am,total:al.length,perPage:6,onPageChange:O})})]}),V&&(0,b.jsxs)("div",{className:"space-y-2 pt-4 border-t",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Selecciona el horario"}),L?(0,b.jsx)("div",{className:"flex justify-center py-4",children:(0,b.jsx)(i.Spinner,{})}):0===J.length?(0,b.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No hay horarios disponibles para este curso"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"space-y-2",children:ap.map(a=>{let c=a.cupo_maximo-(a.cupo_actual||0),d=c<=0;return(0,b.jsx)("button",{onClick:()=>!d&&Y(a.id_grupo),disabled:d,className:`w-full p-3 text-left border rounded-lg transition-all ${d?"opacity-50 cursor-not-allowed bg-gray-50":X===a.id_grupo?"border-green-600 bg-green-50":"border-gray-200 hover:border-green-300"}`,children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:a.nombre}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:[ah(a.hora_inicio||"")," -"," ",ah(a.hora_fin||"")," |"," ",(a=>{if(!a)return"Por definir";let b=[];if("string"==typeof a)try{b=JSON.parse(a)}catch{b=a.split(",").map(a=>a.trim())}else{if(!Array.isArray(a))return"Por definir";b=a}if(!b.length)return"Por definir";let c={0:"Dom",1:"Lun",2:"Mar",3:"Mié",4:"Jue",5:"Vie",6:"Sáb"};return b.map(a=>c[String(a)]||String(a)).join(", ")})(a.dias_semana)]}),a.instructor&&(0,b.jsxs)("p",{className:"text-xs text-gray-600 mt-0.5",children:["Instructor: ",a.instructor.nombre," ",a.instructor.apellido]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded font-medium ${d?"bg-red-100 text-red-700":c<=5?"bg-amber-100 text-amber-700":"bg-green-100 text-green-700"}`,children:d?"Lleno":`${c} cupos`}),X===a.id_grupo&&(0,b.jsx)(o.CheckCircleIcon,{className:"h-5 w-5 text-green-600"})]})]})},a.id_grupo)})}),ao>1&&(0,b.jsx)("div",{className:"flex justify-center pt-2",children:(0,b.jsx)(k.Pagination,{page:R,lastPage:ao,total:J.length,perPage:4,onPageChange:S})})]})]}),(0,b.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,b.jsx)(g.Button,{variant:"secondary",onClick:()=>w("participante"),children:"Atrás"}),(0,b.jsx)(g.Button,{onClick:()=>w("pago"),disabled:!X,children:"Continuar"})]})]}),"pago"===u&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h2",{className:"font-medium",children:"Información de Pago"}),(0,b.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Participante:"}),(0,b.jsxs)("span",{className:"font-medium",children:[aq?.nombres," ",aq?.apellidos]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Curso:"}),(0,b.jsx)("span",{className:"font-medium",children:ar?.nombre})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Horario:"}),(0,b.jsx)("span",{className:"font-medium",children:as?.nombre})]}),(0,b.jsxs)("div",{className:"flex justify-between pt-2 border-t",children:[(0,b.jsx)("span",{className:"font-medium",children:"Total:"}),(0,b.jsx)("span",{className:"text-lg font-bold text-green-600",children:af(ar?.precio||0)})]})]}),(0,b.jsx)(j.Select,{label:"Método de pago",value:Z.metodo_pago,onChange:a=>{$({...Z,metodo_pago:a.target.value}),"tarjeta"===a.target.value&&(aa(null),ac(""))},options:[{value:"transferencia",label:"Transferencia Bancaria"},{value:"efectivo",label:"Efectivo"}]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["Referencia de pago"," ","transferencia"===Z.metodo_pago&&(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",value:Z.referencia,onChange:a=>$({...Z,referencia:a.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"transferencia"===Z.metodo_pago?"Número de referencia de la transferencia":"Número de recibo (opcional)"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Comprobante de pago ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),ab?(0,b.jsxs)("div",{className:"relative border rounded-lg overflow-hidden",children:[(0,b.jsx)("img",{src:ab,alt:"Comprobante",className:"w-full h-48 object-contain bg-gray-50"}),(0,b.jsx)("button",{onClick:()=>{aa(null),ac("")},className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:(0,b.jsx)(q.XMarkIcon,{className:"h-5 w-5"})}),(0,b.jsx)("div",{className:"p-2 bg-gray-50 border-t",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(r.PhotoIcon,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"truncate",children:_?.name})]})})]}):(0,b.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-green-400 transition-colors",children:[(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];if(!b)return;let c=["image/jpeg","image/jpg","image/png","image/webp"].includes(b.type)?b.size>5242880?{valid:!1,error:"La imagen no debe superar 5MB"}:{valid:!0}:{valid:!1,error:"Solo se permiten imágenes (JPG, PNG, WEBP)"};if(!c.valid)return void C(c.error||"Archivo inválido");aa(b);let d=new FileReader;d.onloadend=()=>{ac(d.result)},d.readAsDataURL(b)},className:"hidden",id:"comprobante-upload"}),(0,b.jsxs)("label",{htmlFor:"comprobante-upload",className:"cursor-pointer flex flex-col items-center",children:[(0,b.jsx)(s,{className:"h-12 w-12 text-gray-400 mb-2"}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Subir comprobante"}),(0,b.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG o WEBP (máx. 5MB)"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Observaciones (opcional)"}),(0,b.jsx)("textarea",{value:Z.observaciones,onChange:a=>$({...Z,observaciones:a.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",rows:3,placeholder:"Información adicional sobre el pago..."})]}),(0,b.jsxs)("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-800",children:[(0,b.jsx)("p",{className:"font-medium mb-1",children:"⚠️ Importante:"}),(0,b.jsx)("p",{children:"Tu inscripción quedará pendiente hasta que el administrador verifique el comprobante de pago. Recibirás una notificación cuando sea aprobada."})]}),(0,b.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,b.jsx)(g.Button,{variant:"secondary",onClick:()=>w("curso"),children:"Atrás"}),(0,b.jsx)(g.Button,{onClick:ak,isLoading:z||ad,disabled:!_,children:ad?"Subiendo comprobante...":"Confirmar Inscripción"})]})]}),"confirmacion"===u&&(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)(o.CheckCircleIcon,{className:"h-10 w-10 text-green-600"})}),(0,b.jsx)("h2",{className:"text-xl font-bold mb-2",children:"¡Inscripción Registrada!"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"El administrador verificará tu pago y recibirás confirmación."}),(0,b.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg text-left text-sm mb-6 max-w-sm mx-auto",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Participante:"})," ",aq?.nombres," ",aq?.apellidos]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Curso:"})," ",ar?.nombre]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Grupo:"})," ",as?.nombre]})]}),(0,b.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,b.jsx)(g.Button,{variant:"secondary",onClick:()=>a.push("/mis-participantes"),children:"Ver Participantes"}),(0,b.jsx)(g.Button,{onClick:()=>a.push("/dashboard"),children:"Ir al Dashboard"})]})]})]})]})})}function x(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)(e.DashboardLayout,{children:(0,b.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,b.jsx)(i.Spinner,{})})}),children:(0,b.jsx)(w,{})})}a.s(["default",()=>x],96416)}];

//# sourceMappingURL=80b94_GitHub_proyecto-web2-frontend_src_app_%28dashboard%29_inscribir_page_tsx_1c9e5be3._.js.map