module.exports=[95573,a=>{"use strict";var b=a.i(57692),c=a.i(98620);a.i(67360);var d=a.i(4656);a.i(95994);var e=a.i(77314),f=a.i(91419),g=a.i(60364),h=a.i(62664),i=a.i(72328),j=a.i(86166),k=a.i(29518),l=a.i(2490),m=a.i(65513),n=a.i(29869),o=a.i(77573),p=a.i(60407),q=a.i(74891),r=a.i(57884),s=a.i(89929),t=a.i(92276),u=a.i(23849),v=a.i(65772);function w(){let a,w,x,y,z,A,B,[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)(!1),[W,X]=(0,c.useState)(!1),[Y,Z]=(0,c.useState)({estado:""}),[$,_]=(0,c.useState)(!1),[aa,ab]=(0,c.useState)({numero_factura:"",concepto:"",id_tutor:"",id_deportista:"",subtotal:"",descuento:"",impuesto:"",fecha_emision:"",fecha_vencimiento:"",detalles:[]});(0,c.useEffect)(()=>{l.usuariosService.getAll({per_page:1e3,rol:"tutor"}).then(a=>{let b=[];a?.data&&Array.isArray(a.data)?b=a.data:Array.isArray(a)&&(b=a),D(b)}).catch(a=>{console.error("Error cargando tutores:",a),D([])})},[]);let ac=(0,c.useCallback)(a=>k.facturasService.getAll({...a,...Y}),[Y]),{data:ad,isLoading:ae,page:af,perPage:ag,total:ah,lastPage:ai,search:aj,sortBy:ak,sortOrder:al,goToPage:am,changePerPage:an,handleSearch:ao,handleSort:ap,refetch:aq}=(0,j.usePagination)(ac);ad.reduce((a,b)=>a+Number(b.total||0),0),ad.filter(a=>"pagada"===a.estado).reduce((a,b)=>a+Number(b.total||0),0),ad.filter(a=>"pendiente"===a.estado).reduce((a,b)=>a+Number(b.total||0),0),ad.filter(a=>"vencida"===a.estado).reduce((a,b)=>a+Number(b.total||0),0);let ar=async a=>{if("pendiente"===a.estado)try{await k.facturasService.cambiarEstado(a.id_factura,"pagada"),aq()}catch(a){console.error("Error al marcar como pagada:",a)}},as=async(a,b,c,d,e)=>{if(confirm("¿Aprobar este pago y marcar la factura como pagada?")){X(!0);try{await k.facturasService.registrarPago(a,{monto:b,fecha_pago:new Date().toISOString().split("T")[0],metodo_pago:c,referencia:d||void 0,observaciones:e?`Comprobante: ${e}`:void 0}),F(!1),aq(),alert("Pago aprobado exitosamente")}catch(a){console.error("Error al aprobar pago:",a),alert(a.message||"Error al aprobar el pago")}finally{X(!1)}}},at=async a=>{let b=prompt("Ingrese el motivo del rechazo (se notificará al usuario):");if(b){X(!0);try{await k.facturasService.update(a,{observaciones:`Pago rechazado: ${b}`}),alert("Pago rechazado. Se notificará al usuario."),F(!1),aq()}catch(a){console.error("Error al rechazar pago:",a),alert(a.message||"Error al rechazar el pago")}finally{X(!1)}}},au=async a=>{if(confirm("¿Verificar este pago?")){X(!0);try{await k.pagosService.verificar(a),F(!1),aq(),alert("Pago verificado exitosamente")}catch(a){console.error("Error al verificar pago:",a),alert(a.message||"Error al verificar el pago")}finally{X(!1)}}},av=async a=>{let b=prompt("Ingrese el motivo del rechazo:");if(b){X(!0);try{await k.pagosService.rechazar(a,b),alert("Pago rechazado."),F(!1),aq()}catch(a){console.error("Error al rechazar pago:",a),alert(a.message||"Error al rechazar el pago")}finally{X(!1)}}},aw=a=>{let b=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <title>Factura ${a.numero_factura||a.id_factura}</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 40px; color: #333; }
          .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #4f46e5; padding-bottom: 20px; }
          .header h1 { color: #4f46e5; margin: 0; font-size: 28px; }
          .header p { margin: 5px 0; color: #666; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
          .info-box { background: #f9fafb; padding: 15px; border-radius: 8px; }
          .info-box h3 { margin: 0 0 10px 0; font-size: 14px; color: #6b7280; text-transform: uppercase; }
          .info-box p { margin: 5px 0; font-size: 14px; }
          .estado { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
          .estado-pagada { background: #d1fae5; color: #065f46; }
          .estado-pendiente { background: #fef3c7; color: #92400e; }
          .estado-vencida { background: #fee2e2; color: #991b1b; }
          .totales { margin-top: 30px; border-top: 1px solid #e5e7eb; padding-top: 20px; }
          .total-row { display: flex; justify-content: space-between; padding: 8px 0; font-size: 14px; }
          .total-row.final { font-size: 18px; font-weight: bold; border-top: 2px solid #333; margin-top: 10px; padding-top: 15px; }
          .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #9ca3af; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>FACTURA</h1>
          <p><strong>N\xb0 ${a.numero_factura||"FAC-"+a.id_factura}</strong></p>
          <p>Cursos Vacacionales</p>
        </div>
        
        <div class="info-grid">
          <div class="info-box">
            <h3>Datos del Cliente</h3>
            <p><strong>${a.tutor?`${a.tutor.nombre} ${a.tutor.apellido}`:a.usuario?.nombre||"N/A"}</strong></p>
            <p>${a.tutor?.email||a.usuario?.email||""}</p>
          </div>
          <div class="info-box">
            <h3>Datos de la Factura</h3>
            <p><strong>Fecha:</strong> ${a.fecha_emision||"N/A"}</p>
            <p><strong>Vencimiento:</strong> ${a.fecha_vencimiento||"N/A"}</p>
            <p><strong>Estado:</strong> <span class="estado estado-${a.estado}">${a.estado?.toUpperCase()}</span></p>
          </div>
        </div>

        <div class="info-box">
          <h3>Concepto</h3>
          <p>${a.concepto||"Inscripción a curso vacacional"}</p>
        </div>

        <div class="totales">
          <div class="total-row">
            <span>Subtotal:</span>
            <span>$${Number(a.subtotal||0).toFixed(2)}</span>
          </div>
          ${a.descuento?`
          <div class="total-row" style="color: #059669;">
            <span>Descuento:</span>
            <span>-$${Number(a.descuento).toFixed(2)}</span>
          </div>
          `:""}
          ${a.impuesto?`
          <div class="total-row">
            <span>Impuesto:</span>
            <span>$${Number(a.impuesto).toFixed(2)}</span>
          </div>
          `:""}
          <div class="total-row final">
            <span>TOTAL:</span>
            <span>$${Number(a.total||0).toFixed(2)}</span>
          </div>
        </div>

        <div class="footer">
          <p>Gracias por su preferencia</p>
          <p>Documento generado el ${new Date().toLocaleDateString("es-EC",{timeZone:"America/Guayaquil"})}</p>
        </div>
      </body>
      </html>
    `,c=window.open("","_blank");c&&(c.document.write(b),c.document.close(),c.print())},ax=async()=>{if(Q){T(!0);try{await k.facturasService.delete(Q),aq()}catch(a){console.error("Error:",a)}finally{T(!1),J(!1),R(null)}}},ay=()=>{P(null),ab({numero_factura:"",concepto:"",id_tutor:"",id_deportista:"",subtotal:"",descuento:"",impuesto:"",fecha_emision:"",fecha_vencimiento:"",detalles:[]})},az=async a=>{a.preventDefault();try{let a={numero_factura:aa.numero_factura,concepto:aa.concepto,id_tutor:aa.id_tutor?Number(aa.id_tutor):void 0,subtotal:Number(aa.subtotal),descuento:aa.descuento?Number(aa.descuento):0,impuesto:aa.impuesto?Number(aa.impuesto):0,fecha_emision:aa.fecha_emision,fecha_vencimiento:aa.fecha_vencimiento};O?await k.facturasService.update(O.id_factura,a):await k.facturasService.create(a),H(!1),ay(),aq()}catch(a){console.error("Error:",a)}},aA=[{key:"numero_factura",header:"Número",sortable:!0,render:a=>(0,b.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a.numero_factura})},{key:"cliente",header:"Cliente",render:a=>(0,b.jsx)("span",{className:"text-sm text-gray-600",children:a.tutor?`${a.tutor.nombre} ${a.tutor.apellido}`:a.usuario?.nombre||"-"})},{key:"concepto",header:"Concepto",render:a=>(0,b.jsx)("span",{className:"text-sm text-gray-600 line-clamp-1",children:a.concepto})},{key:"total",header:"Total",sortable:!0,render:a=>(0,b.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",Number(a.total||0).toFixed(2)]})},{key:"fecha_emision",header:"Fecha",sortable:!0,render:a=>(0,b.jsx)("span",{className:"text-sm text-gray-600",children:a.fecha_emision})},{key:"estado",header:"Estado",render:a=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded-full ${"pagada"===a.estado?"bg-emerald-50 text-emerald-600":"pendiente"===a.estado?"bg-amber-50 text-amber-600":"bg-red-50 text-red-600"}`,children:"pagada"===a.estado?"Pagada":"pendiente"===a.estado?"Pendiente":"Vencida"}),"pendiente"===a.estado&&a.pagos&&a.pagos.length>0&&a.pagos.some(a=>"pendiente"===a.estado&&a.comprobante)&&(0,b.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,b.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),(0,b.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-blue-500",title:"Comprobante pendiente de revisión"})]})]})},{key:"acciones",header:"",render:a=>(0,b.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,b.jsx)("button",{onClick:()=>{N(a),F(!0)},className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Ver detalle",children:(0,b.jsx)(o.EyeIcon,{className:"h-4 w-4"})}),(0,b.jsx)("button",{onClick:()=>aw(a),className:"p-1.5 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Descargar PDF",children:(0,b.jsx)(u.ArrowDownTrayIcon,{className:"h-4 w-4"})}),"pendiente"===a.estado&&(0,b.jsx)("button",{onClick:()=>ar(a),title:"Marcar como pagada",className:"p-1.5 text-gray-400 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",children:(0,b.jsx)(s.CreditCardIcon,{className:"h-4 w-4"})}),(0,b.jsx)("button",{onClick:()=>{P(a),ab({numero_factura:a.numero_factura||"",concepto:a.concepto||"",id_tutor:a.id_tutor?.toString()||"",id_deportista:a.id_deportista?.toString()||"",subtotal:a.subtotal?.toString()||"",descuento:a.descuento?.toString()||"",impuesto:a.impuesto?.toString()||"",fecha_emision:a.fecha_emision||"",fecha_vencimiento:a.fecha_vencimiento||"",detalles:[]}),H(!0)},className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Editar",children:(0,b.jsx)(p.PencilSquareIcon,{className:"h-4 w-4"})}),(0,b.jsx)("button",{onClick:()=>{R(a.id_factura),J(!0)},className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar",children:(0,b.jsx)(q.TrashIcon,{className:"h-4 w-4"})})]})}];return(0,b.jsx)(d.DashboardLayout,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg",children:(0,b.jsx)(r.DocumentTextIcon,{className:"h-5 w-5 text-blue-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Facturas"}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[ah," registros"]})]})]}),(0,b.jsxs)(e.Button,{size:"sm",onClick:()=>{ay(),H(!0)},children:[(0,b.jsx)(m.PlusIcon,{className:"h-4 w-4 mr-1"}),"Nueva"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Total Facturado"}),(0,b.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["$",ad.reduce((a,b)=>a+Number(b.total||0),0).toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Pagadas"}),(0,b.jsxs)("p",{className:"text-lg font-semibold text-emerald-600",children:["$",ad.filter(a=>"pagada"===a.estado).reduce((a,b)=>a+Number(b.total||0),0).toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Pendientes"}),(0,b.jsxs)("p",{className:"text-lg font-semibold text-amber-600",children:["$",ad.filter(a=>"pendiente"===a.estado).reduce((a,b)=>a+Number(b.total||0),0).toFixed(2)]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Vencidas"}),(0,b.jsxs)("p",{className:"text-lg font-semibold text-red-600",children:["$",ad.filter(a=>"vencida"===a.estado).reduce((a,b)=>a+Number(b.total||0),0).toFixed(2)]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-100 p-3",children:[(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(n.MagnifyingGlassIcon,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Buscar factura...",value:aj,onChange:a=>ao(a.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500"})]}),(0,b.jsxs)("button",{onClick:()=>_(!$),className:`px-3 py-2 text-sm border rounded-lg flex items-center gap-2 transition-colors ${$?"bg-blue-50 border-blue-200 text-blue-600":"border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[(0,b.jsx)(t.FunnelIcon,{className:"h-4 w-4"}),"Filtros"]})]}),$&&(0,b.jsxs)("div",{className:"flex gap-3 mt-3 pt-3 border-t border-gray-100",children:[(0,b.jsxs)("select",{value:Y.estado,onChange:a=>Z({...Y,estado:a.target.value}),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg",children:[(0,b.jsx)("option",{value:"",children:"Todos los estados"}),(0,b.jsx)("option",{value:"pagada",children:"Pagada"}),(0,b.jsx)("option",{value:"pendiente",children:"Pendiente"}),(0,b.jsx)("option",{value:"vencida",children:"Vencida"})]}),(0,b.jsx)("button",{onClick:()=>Z({estado:""}),className:"text-sm text-gray-500 hover:text-gray-700",children:"Limpiar"})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-100 overflow-hidden",children:[(0,b.jsx)(f.Table,{columns:aA,data:ad,keyExtractor:a=>a.id_factura,isLoading:ae,onSort:ap,sortBy:ak,sortOrder:al}),(0,b.jsx)("div",{className:"border-t border-gray-100",children:(0,b.jsx)(g.Pagination,{page:af,lastPage:ai,total:ah,perPage:ag,onPageChange:am,onPerPageChange:an})})]}),(0,b.jsx)(h.Modal,{isOpen:E,onClose:()=>F(!1),title:`Factura ${M?.numero_factura}`,size:"lg",children:M&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Cliente"}),(0,b.jsx)("p",{className:"text-gray-900",children:M.tutor?`${M.tutor.nombre} ${M.tutor.apellido}`:M.usuario?.nombre||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Estado"}),(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded-full ${"pagada"===M.estado?"bg-emerald-50 text-emerald-600":"pendiente"===M.estado?"bg-amber-50 text-amber-600":"bg-red-50 text-red-600"}`,children:"pagada"===M.estado?"Pagada":"pendiente"===M.estado?"Pendiente":"Vencida"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Fecha Emisión"}),(0,b.jsx)("p",{className:"text-gray-900",children:M.fecha_emision})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Fecha Vencimiento"}),(0,b.jsx)("p",{className:"text-gray-900",children:M.fecha_vencimiento||"-"})]})]}),M.inscripcion?.observaciones&&M.inscripcion.observaciones.includes("Comprobante:")&&"pendiente"===M.estado&&(!M.pagos||0===M.pagos.length)&&(0,b.jsx)("div",{className:"pt-4 border-t border-gray-100",children:(0,b.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-amber-800",children:[(0,b.jsx)(v.PhotoIcon,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"font-medium",children:"Comprobante de Pago Pendiente de Aprobación"})]}),(w=(a=M.inscripcion.observaciones).match(/Comprobante:\s*(\S+)/),x=a.match(/Método:\s*([^-]+)/),y=a.match(/Ref:\s*([^-]+)/),z=w?.[1],A=x?.[1]?.trim(),B=y?.[1]?.trim(),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Monto:"}),(0,b.jsxs)("p",{className:"font-medium",children:["$",Number(M.total||0).toFixed(2)]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Método:"}),(0,b.jsx)("p",{className:"font-medium capitalize",children:A||"No especificado"})]}),B&&"N/A"!==B&&(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Referencia:"}),(0,b.jsx)("p",{className:"font-medium",children:B})]})]}),z&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-gray-600 block mb-2",children:"Comprobante adjunto:"}),(0,b.jsxs)("div",{className:"relative border-2 border-amber-300 rounded-lg overflow-hidden bg-white",children:[(0,b.jsx)("img",{src:z,alt:"Comprobante de pago",className:"w-full h-64 object-contain cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(z,"_blank")}),(0,b.jsx)("div",{className:"absolute top-2 right-2",children:(0,b.jsx)("button",{onClick:()=>window.open(z,"_blank"),className:"p-2 bg-white rounded-full shadow-md hover:bg-gray-50 transition-colors",title:"Ver en tamaño completo",children:(0,b.jsx)(v.PhotoIcon,{className:"h-5 w-5 text-gray-600"})})})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-2 border-t border-amber-200",children:[(0,b.jsx)(e.Button,{size:"sm",onClick:()=>as(M.id_factura,M.total,A||"transferencia",B,z),disabled:W,className:"flex-1",children:W?"Aprobando...":"Aprobar Pago"}),(0,b.jsx)(e.Button,{size:"sm",variant:"secondary",onClick:()=>at(M.id_factura),disabled:W,className:"flex-1 bg-red-50 text-red-600 hover:bg-red-100",children:"Rechazar"})]})]}))]})}),M.pagos&&M.pagos.length>0&&(0,b.jsxs)("div",{className:"pt-4 border-t border-gray-100",children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-2",children:"Comprobante de Pago"}),M.pagos.map(a=>(0,b.jsxs)("div",{className:"space-y-3",children:[a.comprobante&&(0,b.jsxs)("div",{className:"relative border rounded-lg overflow-hidden bg-gray-50",children:[(0,b.jsx)("img",{src:a.comprobante,alt:"Comprobante de pago",className:"w-full h-64 object-contain cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(a.comprobante,"_blank")}),(0,b.jsx)("div",{className:"p-3 bg-white border-t",children:(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-gray-600",children:[(0,b.jsx)("span",{className:"font-medium",children:"Método:"})," ",a.metodo_pago]}),a.referencia&&(0,b.jsxs)("p",{className:"text-gray-600",children:[(0,b.jsx)("span",{className:"font-medium",children:"Ref:"})," ",a.referencia]}),(0,b.jsxs)("p",{className:"text-gray-600",children:[(0,b.jsx)("span",{className:"font-medium",children:"Monto:"})," $",Number(a.monto).toFixed(2)]})]}),(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded-full ${"verificado"===a.estado?"bg-emerald-50 text-emerald-600":"rechazado"===a.estado?"bg-red-50 text-red-600":"bg-amber-50 text-amber-600"}`,children:"verificado"===a.estado?"Verificado":"rechazado"===a.estado?"Rechazado":"Pendiente"})]})})]}),a.observaciones&&(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Observaciones"}),(0,b.jsx)("p",{className:"text-gray-600",children:a.observaciones})]})]},a.id_pago))]}),(0,b.jsxs)("div",{className:"pt-4 border-t border-gray-100",children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Concepto"}),(0,b.jsx)("p",{className:"text-sm text-gray-900",children:M.concepto})]}),(0,b.jsxs)("div",{className:"pt-4 border-t border-gray-100 space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Subtotal"}),(0,b.jsxs)("span",{className:"text-gray-900",children:["$",Number(M.subtotal||0).toFixed(2)]})]}),M.descuento&&(0,b.jsxs)("div",{className:"flex justify-between text-emerald-600",children:[(0,b.jsx)("span",{children:"Descuento"}),(0,b.jsxs)("span",{children:["-$",Number(M.descuento||0).toFixed(2)]})]}),M.impuesto&&(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Impuesto"}),(0,b.jsxs)("span",{className:"text-gray-900",children:["$",Number(M.impuesto||0).toFixed(2)]})]}),(0,b.jsxs)("div",{className:"flex justify-between font-semibold text-base pt-2 border-t border-gray-100",children:[(0,b.jsx)("span",{children:"Total"}),(0,b.jsxs)("span",{children:["$",Number(M.total||0).toFixed(2)]})]})]}),M.pagos&&M.pagos.length>0&&(0,b.jsxs)("div",{className:"pt-4 border-t border-gray-100",children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-3 font-medium",children:"Pagos Registrados"}),(0,b.jsx)("div",{className:"space-y-3",children:M.pagos.map(a=>(0,b.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs",children:"Monto"}),(0,b.jsxs)("p",{className:"font-semibold text-gray-900",children:["$",Number(a.monto||0).toFixed(2)]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs",children:"Fecha"}),(0,b.jsx)("p",{className:"text-gray-900",children:a.fecha_pago})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs",children:"Método"}),(0,b.jsx)("p",{className:"text-gray-900 capitalize",children:a.metodo_pago})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs",children:"Estado"}),(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded-full ${"verificado"===a.estado?"bg-emerald-50 text-emerald-600":"pendiente"===a.estado?"bg-amber-50 text-amber-600":"bg-red-50 text-red-600"}`,children:"verificado"===a.estado?"Verificado":"pendiente"===a.estado?"Pendiente":"Rechazado"})]})]}),a.referencia&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs",children:"Referencia"}),(0,b.jsx)("p",{className:"text-sm text-gray-900",children:a.referencia})]}),a.comprobante&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-2",children:"Comprobante"}),(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)("img",{src:a.comprobante,alt:"Comprobante de pago",className:"w-full h-48 object-contain bg-white border border-gray-200 rounded-lg cursor-pointer hover:border-blue-400 transition-colors",onClick:()=>window.open(a.comprobante,"_blank")}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 rounded-lg transition-all flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-white opacity-0 group-hover:opacity-100 text-sm font-medium",children:"Click para ampliar"})})]})]}),a.observaciones&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs",children:"Observaciones"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:a.observaciones})]}),"pendiente"===a.estado&&(0,b.jsxs)("div",{className:"flex gap-2 pt-2 border-t border-gray-200",children:[(0,b.jsx)(e.Button,{size:"sm",variant:"secondary",onClick:()=>av(a.id_pago),disabled:W,className:"flex-1 bg-red-50 text-red-600 hover:bg-red-100",children:"Rechazar"}),(0,b.jsx)(e.Button,{size:"sm",onClick:()=>au(a.id_pago),disabled:W,className:"flex-1",children:W?"Verificando...":"Verificar Pago"})]})]},a.id_pago))})]}),(0,b.jsxs)("div",{className:"pt-4 border-t border-gray-100 flex justify-between items-center",children:[(0,b.jsx)("div",{className:"flex gap-2",children:"pendiente"===M.estado&&M.pagos&&M.pagos.length>0&&M.pagos.some(a=>"pendiente"===a.estado)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{size:"sm",variant:"secondary",onClick:()=>{let a=M.pagos?.find(a=>"pendiente"===a.estado);a&&av(a.id_pago)},disabled:W,className:"bg-red-50 text-red-600 hover:bg-red-100 border-red-200",children:"Rechazar Pago"}),(0,b.jsx)(e.Button,{size:"sm",onClick:()=>{let a=M.pagos?.find(a=>"pendiente"===a.estado);a&&au(a.id_pago)},disabled:W,className:"bg-emerald-600 hover:bg-emerald-700",children:W?"Procesando...":"Aprobar Pago"})]})}),(0,b.jsxs)(e.Button,{size:"sm",variant:"secondary",onClick:()=>aw(M),children:[(0,b.jsx)(u.ArrowDownTrayIcon,{className:"h-4 w-4 mr-1"}),"Descargar PDF"]})]})]})}),(0,b.jsx)(h.Modal,{isOpen:G,onClose:()=>H(!1),title:`${O?"Editar":"Nueva"} Factura`,size:"md",children:(0,b.jsxs)("form",{onSubmit:az,className:"space-y-3",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Número de Factura"}),(0,b.jsx)("input",{type:"text",value:aa.numero_factura,onChange:a=>ab({...aa,numero_factura:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Cliente (Tutor)"}),(0,b.jsxs)("select",{value:aa.id_tutor,onChange:a=>ab({...aa,id_tutor:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg",children:[(0,b.jsx)("option",{value:"",children:"Seleccionar"}),C.map(a=>(0,b.jsxs)("option",{value:a.id_usuario,children:[a.nombre," ",a.apellido]},a.id_usuario))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Concepto"}),(0,b.jsx)("input",{type:"text",value:aa.concepto,onChange:a=>ab({...aa,concepto:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Subtotal"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:aa.subtotal,onChange:a=>ab({...aa,subtotal:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Descuento"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:aa.descuento,onChange:a=>ab({...aa,descuento:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Impuesto"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:aa.impuesto,onChange:a=>ab({...aa,impuesto:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Fecha Emisión"}),(0,b.jsx)("input",{type:"date",value:aa.fecha_emision,onChange:a=>ab({...aa,fecha_emision:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Fecha Vencimiento"}),(0,b.jsx)("input",{type:"date",value:aa.fecha_vencimiento,onChange:a=>ab({...aa,fecha_vencimiento:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg"})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-3",children:[(0,b.jsx)(e.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>H(!1),children:"Cancelar"}),(0,b.jsx)(e.Button,{type:"submit",size:"sm",children:O?"Actualizar":"Crear"})]})]})}),(0,b.jsx)(i.ConfirmModal,{isOpen:I,onClose:()=>J(!1),onConfirm:ax,title:"¿Eliminar factura?",message:"Esta acción no se puede deshacer.",isLoading:S})]})})}a.s(["default",()=>w])}];

//# sourceMappingURL=7889e_proyecto-web2-frontend_src_app_%28dashboard%29_finanzas_facturas_page_tsx_71719379._.js.map