module.exports=[62499,a=>{"use strict";var b=a.i(57692),c=a.i(98620);a.i(67360);var d=a.i(4656);a.i(95994);var e=a.i(77314),f=a.i(91419),g=a.i(60364),h=a.i(62664),i=a.i(72328),j=a.i(86166),k=a.i(2490),l=a.i(65513),m=a.i(29869),n=a.i(77573),o=a.i(60407),p=a.i(74891),q=a.i(65857),r=a.i(92276);function s(){let[a,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)({status:"",id_rol:""}),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)({}),[P,Q]=(0,c.useState)({nombre:"",apellido:"",email:"",cedula:"",telefono:"",id_rol:"",password:"",password_confirmation:""});(0,c.useEffect)(()=>{k.rolesService.getAll().then(a=>{s(Array.isArray(a)?a:a?.data||[])}).catch(console.error)},[]);let R=(0,c.useCallback)(a=>{let b={};return J.status&&(b.status=J.status),J.id_rol&&(b.id_rol=J.id_rol),k.usuariosService.getAll({...a,...b})},[J]),{data:S,isLoading:T,page:U,perPage:V,total:W,lastPage:X,search:Y,sortBy:Z,sortOrder:$,goToPage:_,changePerPage:aa,handleSearch:ab,handleSort:ac,refetch:ad}=(0,j.usePagination)(R),ae=async(a,b)=>{await k.usuariosService.cambiarEstado(a,b),ad()},af=async()=>{if(D){G(!0);try{await k.usuariosService.delete(D),ad()}catch(a){console.error("Error:",a)}finally{G(!1),y(!1),E(null)}}},ag=()=>{C(null),O({}),Q({nombre:"",apellido:"",email:"",cedula:"",telefono:"",id_rol:"",password:"",password_confirmation:""})},ah=async a=>{let b;if(a.preventDefault(),b={},P.nombre.trim()||(b.nombre="El nombre es requerido"),P.apellido.trim()||(b.apellido="El apellido es requerido"),P.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(P.email)||(b.email="El email no es válido"):b.email="El email es requerido",P.id_rol||(b.id_rol="Debe seleccionar un rol"),(!B||P.password)&&(P.password?P.password.length<8&&(b.password="La contraseña debe tener al menos 8 caracteres"):b.password="La contraseña es requerida",P.password_confirmation?P.password!==P.password_confirmation&&(b.password_confirmation="Las contraseñas no coinciden"):b.password_confirmation="Debe confirmar la contraseña"),O(b),0===Object.keys(b).length){I(!0),O({});try{if(B){let a={nombre:P.nombre,apellido:P.apellido,email:P.email,cedula:P.cedula,telefono:P.telefono,id_rol:P.id_rol?Number(P.id_rol):void 0};P.password&&(a.password=P.password,a.password_confirmation=P.password_confirmation),await k.usuariosService.update(B.id_usuario,a)}else await k.usuariosService.create({nombre:P.nombre,apellido:P.apellido,email:P.email,cedula:P.cedula,telefono:P.telefono,id_rol:P.id_rol?Number(P.id_rol):void 0,password:P.password,password_confirmation:P.password_confirmation});w(!1),ag(),ad()}catch(a){if(console.error("Error:",a),422===a.status&&a.errors){let b={};Object.keys(a.errors).forEach(c=>{b[c]=a.errors[c][0]}),O(b)}else O({general:a.message||"Error al guardar el usuario. Por favor verifica los datos."})}finally{I(!1)}}},ai=[{key:"nombre",header:"Usuario",sortable:!0,render:a=>(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-purple-50 rounded-lg flex items-center justify-center text-purple-600 text-sm font-medium",children:a.nombre?.charAt(0)}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[a.nombre," ",a.apellido]}),(0,b.jsx)("p",{className:"text-xs text-gray-400",children:a.email})]})]})},{key:"rol",header:"Rol",render:a=>(0,b.jsx)("span",{className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded-full",children:a.rol?.nombre||"Sin rol"})},{key:"cedula",header:"Cédula",render:a=>(0,b.jsx)("span",{className:"text-sm text-gray-600",children:a.cedula||"-"})},{key:"status",header:"Estado",render:a=>(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded-full ${"activo"===a.status?"bg-emerald-50 text-emerald-600":"suspendido"===a.status?"bg-red-50 text-red-600":"bg-gray-100 text-gray-500"}`,children:"activo"===a.status?"Activo":"suspendido"===a.status?"Suspendido":"Inactivo"})},{key:"acciones",header:"",render:a=>(0,b.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,b.jsx)("button",{onClick:()=>{A(a),u(!0)},className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(n.EyeIcon,{className:"h-4 w-4"})}),(0,b.jsx)("button",{onClick:()=>{C(a),Q({nombre:a.nombre||"",apellido:a.apellido||"",email:a.email||"",cedula:a.cedula||"",telefono:a.telefono||"",id_rol:a.id_rol?.toString()||"",password:"",password_confirmation:""}),w(!0)},className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:(0,b.jsx)(o.PencilSquareIcon,{className:"h-4 w-4"})}),(0,b.jsx)("button",{onClick:()=>{E(a.id_usuario),y(!0)},className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:(0,b.jsx)(p.TrashIcon,{className:"h-4 w-4"})})]})}];return(0,b.jsx)(d.DashboardLayout,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-purple-50 rounded-lg",children:(0,b.jsx)(q.UsersIcon,{className:"h-5 w-5 text-purple-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Usuarios"}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[W," registros"]})]})]}),(0,b.jsxs)(e.Button,{size:"sm",onClick:()=>{ag(),w(!0)},children:[(0,b.jsx)(l.PlusIcon,{className:"h-4 w-4 mr-1"}),"Nuevo"]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-100 p-3",children:[(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(m.MagnifyingGlassIcon,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Buscar usuario...",value:Y,onChange:a=>ab(a.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500"})]}),(0,b.jsxs)("button",{onClick:()=>M(!L),className:`px-3 py-2 text-sm border rounded-lg flex items-center gap-2 transition-colors ${L?"bg-purple-50 border-purple-200 text-purple-600":"border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[(0,b.jsx)(r.FunnelIcon,{className:"h-4 w-4"}),"Filtros"]})]}),L&&(0,b.jsxs)("div",{className:"flex gap-3 mt-3 pt-3 border-t border-gray-100",children:[(0,b.jsxs)("select",{value:J.status,onChange:a=>K({...J,status:a.target.value}),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg",children:[(0,b.jsx)("option",{value:"",children:"Todos los estados"}),(0,b.jsx)("option",{value:"activo",children:"Activo"}),(0,b.jsx)("option",{value:"inactivo",children:"Inactivo"}),(0,b.jsx)("option",{value:"suspendido",children:"Suspendido"})]}),(0,b.jsxs)("select",{value:J.id_rol,onChange:a=>K({...J,id_rol:a.target.value}),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg",children:[(0,b.jsx)("option",{value:"",children:"Todos los roles"}),a.map(a=>(0,b.jsx)("option",{value:a.id_rol,children:a.nombre},a.id_rol))]}),(0,b.jsx)("button",{onClick:()=>K({status:"",id_rol:""}),className:"text-sm text-gray-500 hover:text-gray-700",children:"Limpiar"})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-100 overflow-hidden",children:[(0,b.jsx)(f.Table,{columns:ai,data:S,keyExtractor:a=>a.id_usuario,isLoading:T,onSort:ac,sortBy:Z,sortOrder:$}),(0,b.jsx)("div",{className:"border-t border-gray-100",children:(0,b.jsx)(g.Pagination,{page:U,lastPage:X,total:W,perPage:V,onPageChange:_,onPerPageChange:aa})})]}),(0,b.jsx)(h.Modal,{isOpen:t,onClose:()=>u(!1),title:"Detalle del Usuario",size:"lg",children:z&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 pb-4 border-b border-gray-100",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-purple-50 rounded-xl flex items-center justify-center text-purple-600 text-lg font-medium",children:z.nombre?.charAt(0)}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"font-medium text-gray-900",children:[z.nombre," ",z.apellido]}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:z.email})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Cédula"}),(0,b.jsx)("p",{className:"text-gray-900",children:z.cedula||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Teléfono"}),(0,b.jsx)("p",{className:"text-gray-900",children:z.telefono||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Rol"}),(0,b.jsx)("p",{className:"text-gray-900",children:z.rol?.nombre||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-1",children:"Estado"}),(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded-full ${"activo"===z.status?"bg-emerald-50 text-emerald-600":"suspendido"===z.status?"bg-red-50 text-red-600":"bg-gray-100 text-gray-500"}`,children:"activo"===z.status?"Activo":"suspendido"===z.status?"Suspendido":"Inactivo"})]})]}),(0,b.jsxs)("div",{className:"pt-4 border-t border-gray-100",children:[(0,b.jsx)("p",{className:"text-gray-400 text-xs mb-2",children:"Cambiar Estado"}),(0,b.jsxs)("select",{value:z.status,onChange:a=>ae(z.id_usuario,a.target.value),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500",children:[(0,b.jsx)("option",{value:"activo",children:"Activo"}),(0,b.jsx)("option",{value:"inactivo",children:"Inactivo"}),(0,b.jsx)("option",{value:"suspendido",children:"Suspendido"})]})]})]})}),(0,b.jsx)(h.Modal,{isOpen:v,onClose:()=>w(!1),title:`${B?"Editar":"Nuevo"} Usuario`,size:"md",children:(0,b.jsxs)("form",{onSubmit:ah,className:"space-y-3",children:[N.general&&(0,b.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-red-600",children:N.general})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Nombre"}),(0,b.jsx)("input",{type:"text",value:P.nombre,onChange:a=>{Q({...P,nombre:a.target.value}),N.nombre&&O({...N,nombre:""})},className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 ${N.nombre?"border-red-300 bg-red-50":"border-gray-200"}`}),N.nombre&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:N.nombre})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Apellido"}),(0,b.jsx)("input",{type:"text",value:P.apellido,onChange:a=>{Q({...P,apellido:a.target.value}),N.apellido&&O({...N,apellido:""})},className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 ${N.apellido?"border-red-300 bg-red-50":"border-gray-200"}`}),N.apellido&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:N.apellido})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Email"}),(0,b.jsx)("input",{type:"email",value:P.email,onChange:a=>{Q({...P,email:a.target.value}),N.email&&O({...N,email:""})},className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 ${N.email?"border-red-300 bg-red-50":"border-gray-200"}`}),N.email&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:N.email})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Cédula"}),(0,b.jsx)("input",{type:"text",value:P.cedula,onChange:a=>{Q({...P,cedula:a.target.value}),N.cedula&&O({...N,cedula:""})},className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 ${N.cedula?"border-red-300 bg-red-50":"border-gray-200"}`}),N.cedula&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:N.cedula})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Teléfono"}),(0,b.jsx)("input",{type:"text",value:P.telefono,onChange:a=>{Q({...P,telefono:a.target.value}),N.telefono&&O({...N,telefono:""})},className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 ${N.telefono?"border-red-300 bg-red-50":"border-gray-200"}`}),N.telefono&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:N.telefono})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Rol"}),(0,b.jsxs)("select",{value:P.id_rol,onChange:a=>{Q({...P,id_rol:a.target.value}),N.id_rol&&O({...N,id_rol:""})},className:`w-full px-3 py-2 text-sm border rounded-lg ${N.id_rol?"border-red-300 bg-red-50":"border-gray-200"}`,children:[(0,b.jsx)("option",{value:"",children:"Seleccionar"}),a.map(a=>(0,b.jsx)("option",{value:a.id_rol,children:a.nombre},a.id_rol))]}),N.id_rol&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:N.id_rol})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Contraseña ",B&&"(opcional)"]}),(0,b.jsx)("input",{type:"password",value:P.password,onChange:a=>{Q({...P,password:a.target.value}),N.password&&O({...N,password:""})},className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 ${N.password?"border-red-300 bg-red-50":"border-gray-200"}`,placeholder:"Mínimo 8 caracteres"}),N.password&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:N.password})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Confirmar Contraseña"}),(0,b.jsx)("input",{type:"password",value:P.password_confirmation,onChange:a=>{Q({...P,password_confirmation:a.target.value}),N.password_confirmation&&O({...N,password_confirmation:""})},className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 ${N.password_confirmation?"border-red-300 bg-red-50":"border-gray-200"}`,placeholder:"Confirmar contraseña"}),N.password_confirmation&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:N.password_confirmation})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-3",children:[(0,b.jsx)(e.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>{w(!1),ag()},disabled:H,children:"Cancelar"}),(0,b.jsx)(e.Button,{type:"submit",size:"sm",disabled:H,children:H?"Guardando...":B?"Actualizar":"Crear"})]})]})}),(0,b.jsx)(i.ConfirmModal,{isOpen:x,onClose:()=>y(!1),onConfirm:af,title:"¿Eliminar usuario?",message:"Esta acción no se puede deshacer.",isLoading:F})]})})}a.s(["default",()=>s])}];

//# sourceMappingURL=7889e_proyecto-web2-frontend_src_app_%28dashboard%29_sistema_usuarios_page_tsx_a8246f7f._.js.map