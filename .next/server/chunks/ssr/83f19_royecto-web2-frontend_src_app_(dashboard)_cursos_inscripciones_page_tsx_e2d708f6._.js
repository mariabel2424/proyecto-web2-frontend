module.exports=[92265,a=>{"use strict";var b=a.i(57692),c=a.i(98620),d=a.i(28632);a.i(67360);var e=a.i(4656);a.i(95994);var f=a.i(77314),g=a.i(91419),h=a.i(60364),i=a.i(62664),j=a.i(72328),k=a.i(63953),l=a.i(86166),m=a.i(91587),n=a.i(21248),o=a.i(87728),p=a.i(65513),q=a.i(29869),r=a.i(33093),s=a.i(97422),t=a.i(74891),u=a.i(92276),v=a.i(18364);function w(){(0,m.useAuth)();let a=(0,d.useSearchParams)(),[k,w]=(0,c.useState)([]),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)({estado:"",id_curso:""}),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(!0),[Z,$]=(0,c.useState)({id_curso:"",id_grupo:"",id_deportista:"",observaciones:""});(0,c.useEffect)(()=>{(async()=>{try{let[b,c]=await Promise.all([n.cursosService.getAll({per_page:100}),o.deportistasService.getAll({per_page:100})]),d=Array.isArray(b)?b:b?.data||[],e=Array.isArray(c)?c:c?.data||[];console.log("Cursos cargados:",d.length,d),console.log("Deportistas cargados:",e.length),w(d),A(e);let f=a.get("curso"),g=a.get("grupo");f&&($(a=>({...a,id_curso:f,id_grupo:g||""})),E(!0))}catch(a){console.error("Error cargando datos:",a),w([]),A([])}})()},[a]),(0,c.useEffect)(()=>{Z.id_curso?(async()=>{try{let a=await n.gruposCursoService.getAll({id_curso:Number(Z.id_curso),per_page:100}),b=Array.isArray(a)?a:a?.data||[];console.log("Grupos cargados para curso",Z.id_curso,":",b.length,b),y(b)}catch(a){console.error("Error cargando grupos:",a),y([])}})():(y([]),$(a=>({...a,id_grupo:""})))},[Z.id_curso]);let _=(0,c.useCallback)(a=>n.inscripcionesService.getAll({...a,...T}),[T]),{data:aa,isLoading:ab,page:ac,perPage:ad,total:ae,lastPage:af,search:ag,sortBy:ah,sortOrder:ai,goToPage:aj,changePerPage:ak,handleSearch:al,handleSort:am,refetch:an}=(0,l.usePagination)(_),ao=async()=>{if(H){O(!0);try{await n.inscripcionesService.calificar(H.id_inscripcion,Number(P),R||void 0),C(!1),I(null),Q(""),S(""),an()}catch(a){console.error("Error calificando:",a)}finally{O(!1)}}},ap=async a=>{if(confirm("¿Estás seguro de cancelar esta inscripción?"))try{await n.inscripcionesService.cancelar(a),an()}catch(a){console.error("Error cancelando inscripción:",a)}},aq=async()=>{if(J){M(!0);try{await n.inscripcionesService.delete(J),an()}catch(a){console.error("Error:",a)}finally{M(!1),G(!1),K(null)}}},ar=async a=>{a.preventDefault(),O(!0);try{await n.inscripcionesService.create({id_curso:Number(Z.id_curso),id_grupo:Number(Z.id_grupo),id_deportista:Number(Z.id_deportista),observaciones:Z.observaciones||void 0,generar_factura:X}),E(!1),$({id_curso:"",id_grupo:"",id_deportista:"",observaciones:""}),Y(!0),an()}catch(a){console.error("Error:",a)}finally{O(!1)}},as=[{key:"deportista",header:"Deportista",render:a=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-7 h-7 bg-blue-50 rounded-lg flex items-center justify-center text-blue-600 text-xs font-medium",children:a.deportista?.nombres?.charAt(0)||"?"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a.deportista?.nombre_completo||`${a.deportista?.nombres||""} ${a.deportista?.apellidos||""}`.trim()||"-"}),(0,b.jsx)("p",{className:"text-xs text-gray-400",children:a.deportista?.cedula||"-"})]})]})},{key:"curso",header:"Curso",render:a=>(0,b.jsx)("span",{className:"text-sm text-gray-600",children:a.curso?.nombre||"-"})},{key:"grupo",header:"Grupo",render:a=>(0,b.jsx)("span",{className:"text-sm text-gray-600",children:a.grupo?.nombre||"-"})},{key:"fecha",header:"Fecha",render:a=>(0,b.jsx)("span",{className:"text-sm text-gray-600",children:a.fecha_inscripcion||"-"})},{key:"estado",header:"Estado",render:a=>(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded-full ${(a=>{switch(a){case"activa":return"bg-emerald-50 text-emerald-600";case"completada":return"bg-blue-50 text-blue-600";case"cancelada":return"bg-red-50 text-red-600";case"abandonada":return"bg-amber-50 text-amber-600";default:return"bg-gray-100 text-gray-500"}})(a.estado)}`,children:a.estado})},{key:"calificacion",header:"Calificación",render:a=>(0,b.jsx)("span",{className:"text-sm font-medium text-gray-900",children:null!==a.calificacion&&void 0!==a.calificacion?a.calificacion:"-"})},{key:"acciones",header:"",render:a=>(0,b.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,b.jsx)("button",{onClick:()=>{I(a),Q(a.calificacion?.toString()||""),S(a.comentarios||""),C(!0)},className:"p-1.5 text-gray-400 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",title:"Calificar",children:(0,b.jsx)(r.CheckCircleIcon,{className:"h-4 w-4"})}),"activa"===a.estado&&(0,b.jsx)("button",{onClick:()=>ap(a.id_inscripcion),className:"p-1.5 text-gray-400 hover:text-amber-600 hover:bg-amber-50 rounded-lg transition-colors",title:"Cancelar inscripción",children:(0,b.jsx)(v.XCircleIcon,{className:"h-4 w-4"})}),(0,b.jsx)("button",{onClick:()=>{K(a.id_inscripcion),G(!0)},className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar",children:(0,b.jsx)(t.TrashIcon,{className:"h-4 w-4"})})]})}];return(0,b.jsx)(e.DashboardLayout,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg",children:(0,b.jsx)(s.ClipboardDocumentCheckIcon,{className:"h-5 w-5 text-blue-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Inscripciones"}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[ae," registros"]})]})]}),(0,b.jsxs)(f.Button,{size:"sm",onClick:()=>E(!0),children:[(0,b.jsx)(p.PlusIcon,{className:"h-4 w-4 mr-1"}),"Nueva Inscripción"]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-100 p-3",children:[(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(q.MagnifyingGlassIcon,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Buscar inscripción...",value:ag,onChange:a=>al(a.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500"})]}),(0,b.jsxs)("button",{onClick:()=>W(!V),className:`px-3 py-2 text-sm border rounded-lg flex items-center gap-2 transition-colors ${V?"bg-blue-50 border-blue-200 text-blue-600":"border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[(0,b.jsx)(u.FunnelIcon,{className:"h-4 w-4"}),"Filtros"]})]}),V&&(0,b.jsxs)("div",{className:"flex gap-3 mt-3 pt-3 border-t border-gray-100",children:[(0,b.jsxs)("select",{value:T.estado,onChange:a=>U({...T,estado:a.target.value}),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20",children:[(0,b.jsx)("option",{value:"",children:"Todos los estados"}),(0,b.jsx)("option",{value:"activa",children:"Activa"}),(0,b.jsx)("option",{value:"completada",children:"Completada"}),(0,b.jsx)("option",{value:"cancelada",children:"Cancelada"}),(0,b.jsx)("option",{value:"abandonada",children:"Abandonada"})]}),(0,b.jsxs)("select",{value:T.id_curso,onChange:a=>U({...T,id_curso:a.target.value}),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20",children:[(0,b.jsx)("option",{value:"",children:"Todos los cursos"}),k.map(a=>(0,b.jsx)("option",{value:a.id_curso,children:a.nombre},a.id_curso))]}),(0,b.jsx)("button",{onClick:()=>U({estado:"",id_curso:""}),className:"text-sm text-gray-500 hover:text-gray-700",children:"Limpiar"})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-100 overflow-hidden",children:[(0,b.jsx)(g.Table,{columns:as,data:aa,keyExtractor:a=>a.id_inscripcion,isLoading:ab,onSort:am,sortBy:ah,sortOrder:ai}),(0,b.jsx)("div",{className:"border-t border-gray-100",children:(0,b.jsx)(h.Pagination,{page:ac,lastPage:af,total:ae,perPage:ad,onPageChange:aj,onPerPageChange:ak})})]}),(0,b.jsx)(i.Modal,{isOpen:B,onClose:()=>C(!1),title:"Calificar Inscripción",size:"sm",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"pb-3 border-b border-gray-100",children:[(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:["Deportista:"," ",(0,b.jsx)("span",{className:"font-medium text-gray-900",children:H?.deportista?.nombre_completo||`${H?.deportista?.nombres||""} ${H?.deportista?.apellidos||""}`.trim()})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:["Curso:"," ",(0,b.jsx)("span",{className:"font-medium text-gray-900",children:H?.curso?.nombre})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Calificación (0-10)"}),(0,b.jsx)("input",{type:"number",min:"0",max:"10",step:"0.1",value:P,onChange:a=>Q(a.target.value),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Comentarios"}),(0,b.jsx)("textarea",{value:R,onChange:a=>S(a.target.value),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",rows:2})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,b.jsx)(f.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>C(!1),children:"Cancelar"}),(0,b.jsx)(f.Button,{size:"sm",onClick:ao,disabled:N,children:N?"Guardando...":"Guardar"})]})]})}),(0,b.jsx)(i.Modal,{isOpen:D,onClose:()=>E(!1),title:"Nueva Inscripción",size:"md",children:(0,b.jsxs)("form",{onSubmit:ar,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Curso *"}),(0,b.jsxs)("select",{value:Z.id_curso,onChange:a=>$({...Z,id_curso:a.target.value,id_grupo:""}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Seleccionar curso"}),k.filter(a=>"abierto"===a.estado).map(a=>(0,b.jsx)("option",{value:a.id_curso,children:a.nombre},a.id_curso))]}),0===k.filter(a=>"abierto"===a.estado).length&&(0,b.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"No hay cursos abiertos disponibles"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Grupo *"}),(0,b.jsxs)("select",{value:Z.id_grupo,onChange:a=>$({...Z,id_grupo:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 disabled:bg-gray-50 disabled:text-gray-400",required:!0,disabled:!Z.id_curso,children:[(0,b.jsx)("option",{value:"",children:Z.id_curso?"Seleccionar grupo":"Primero selecciona un curso"}),Z.id_curso&&x.filter(a=>"activo"===a.estado).map(a=>(0,b.jsxs)("option",{value:a.id_grupo,children:[a.nombre," (",a.cupo_actual||0,"/",a.cupo_maximo," ","inscritos)"]},a.id_grupo))]}),Z.id_curso&&0===x.filter(a=>"activo"===a.estado).length&&(0,b.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"No hay grupos activos para este curso"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Deportista *"}),(0,b.jsxs)("select",{value:Z.id_deportista,onChange:a=>$({...Z,id_deportista:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Seleccionar deportista"}),z.filter(a=>"activo"===a.estado).map(a=>(0,b.jsxs)("option",{value:a.id_deportista,children:[a.nombres," ",a.apellidos," - ",a.cedula||"Sin cédula"]},a.id_deportista))]}),0===z.filter(a=>"activo"===a.estado).length&&(0,b.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"No hay deportistas activos disponibles"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Observaciones"}),(0,b.jsx)("textarea",{value:Z.observaciones,onChange:a=>$({...Z,observaciones:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",rows:2})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"generar_factura",checked:X,onChange:a=>Y(a.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,b.jsx)("label",{htmlFor:"generar_factura",className:"text-sm text-gray-600",children:"Generar factura automáticamente"})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-3 border-t border-gray-100",children:[(0,b.jsx)(f.Button,{type:"button",variant:"secondary",size:"sm",onClick:()=>E(!1),children:"Cancelar"}),(0,b.jsx)(f.Button,{type:"submit",size:"sm",disabled:N,children:N?"Guardando...":"Inscribir"})]})]})}),(0,b.jsx)(j.ConfirmModal,{isOpen:F,onClose:()=>G(!1),onConfirm:aq,title:"¿Eliminar inscripción?",message:"Esta acción no se puede deshacer. La inscripción será eliminada permanentemente.",isLoading:L})]})})}function x(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)(e.DashboardLayout,{children:(0,b.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,b.jsx)(k.Spinner,{})})}),children:(0,b.jsx)(w,{})})}a.s(["default",()=>x])}];

//# sourceMappingURL=83f19_royecto-web2-frontend_src_app_%28dashboard%29_cursos_inscripciones_page_tsx_e2d708f6._.js.map