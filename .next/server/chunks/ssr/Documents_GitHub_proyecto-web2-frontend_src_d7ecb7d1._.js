module.exports=[2490,a=>{"use strict";var b=a.i(21652),c=a.i(34680);a.s(["instructoresService",0,{async getAll(a){let{data:d}=await b.apiClient.get(c.API_ENDPOINTS.instructores,a);if(d&&"object"==typeof d&&"success"in d&&d.data){let a=d.data;return Array.isArray(a)?{data:a,total:a.length,current_page:1,last_page:1,per_page:a.length,from:1,to:a.length}:a}return Array.isArray(d)?{data:d,total:d.length,current_page:1,last_page:1,per_page:d.length,from:1,to:d.length}:d},async getDisponibles(){let{data:a}=await b.apiClient.get(`${c.API_ENDPOINTS.instructores}/disponibles/listar`);return a&&"object"==typeof a&&"instructores"in a?a.instructores.map(a=>({id_usuario:a.id_usuario||a.id_instructor||0,nombre:a.nombres||a.nombre||"",apellido:a.apellidos||a.apellido||"",email:a.email||"",especialidad:a.especialidad,status:"activo",id_rol:0,created_at:"",updated_at:""})):a&&"object"==typeof a&&"data"in a?a.data:a}},"rolesService",0,{async getAll(){console.log("Llamando a:",c.API_ENDPOINTS.roles);let{data:a}=await b.apiClient.get(c.API_ENDPOINTS.roles);return console.log("Respuesta roles:",a),Array.isArray(a)?a:a.data},async getById(a){let{data:d}=await b.apiClient.get(`${c.API_ENDPOINTS.roles}/${a}`);return d},async create(a){let{data:d}=await b.apiClient.post(c.API_ENDPOINTS.roles,a);return d.data},async update(a,d){let{data:e}=await b.apiClient.put(`${c.API_ENDPOINTS.roles}/${a}`,d);return e.data},async delete(a){await b.apiClient.delete(`${c.API_ENDPOINTS.roles}/${a}`)}},"usuariosService",0,{async getAll(a){let{data:d}=await b.apiClient.get(c.API_ENDPOINTS.usuarios,a);if(d&&"object"==typeof d&&"success"in d&&d.data){let a=d.data;return Array.isArray(a)?{data:a,total:a.length,current_page:1,last_page:1,per_page:a.length,from:1,to:a.length}:a}return Array.isArray(d)?{data:d,total:d.length,current_page:1,last_page:1,per_page:d.length,from:1,to:d.length}:d},async getById(a){let{data:d}=await b.apiClient.get(`${c.API_ENDPOINTS.usuarios}/${a}`);return d},async create(a){let{data:d}=await b.apiClient.post(c.API_ENDPOINTS.usuarios,a);return d},async update(a,d){let{data:e}=await b.apiClient.put(`${c.API_ENDPOINTS.usuarios}/${a}`,d);return e},async delete(a){await b.apiClient.delete(`${c.API_ENDPOINTS.usuarios}/${a}`)},async cambiarEstado(a,d){let{data:e}=await b.apiClient.put(`${c.API_ENDPOINTS.usuarios}/${a}/estado`,{status:d});return e}}])},29518,a=>{"use strict";var b=a.i(21652),c=a.i(34680);a.s(["facturasService",0,{async getAll(a){let{data:d}=await b.apiClient.get(c.API_ENDPOINTS.facturas,a);if(d&&"object"==typeof d&&"success"in d&&d.data){let a=d.data;return Array.isArray(a)?{data:a,total:a.length,current_page:1,last_page:1,per_page:a.length,from:1,to:a.length}:a}return Array.isArray(d)?{data:d,total:d.length,current_page:1,last_page:1,per_page:d.length,from:1,to:d.length}:d},async getById(a){let{data:d}=await b.apiClient.get(`${c.API_ENDPOINTS.facturas}/${a}`);return d},async create(a){let{data:d}=await b.apiClient.post(c.API_ENDPOINTS.facturas,a);return d},async update(a,d){let{data:e}=await b.apiClient.put(`${c.API_ENDPOINTS.facturas}/${a}`,d);return e},async delete(a){await b.apiClient.delete(`${c.API_ENDPOINTS.facturas}/${a}`)},async cambiarEstado(a,d){let{data:e}=await b.apiClient.put(`${c.API_ENDPOINTS.facturas}/${a}`,{estado:d});return e},async registrarPago(a,d){let{data:e}=await b.apiClient.post(`${c.API_ENDPOINTS.facturas}/${a}/registrar-pago`,d);return e},async generarDesdeInscripcion(a,d){let{data:e}=await b.apiClient.post(`${c.API_ENDPOINTS.facturas}/generar-desde-inscripcion/${a}`,{id_tutor:d});return e},async getFacturasPorTutor(a){let{data:d}=await b.apiClient.get(`${c.API_ENDPOINTS.facturas}/tutor/${a}`);return d},async getReporteFacturacion(a){let{data:d}=await b.apiClient.get(`${c.API_ENDPOINTS.facturas}/reporte/facturacion`,a);return d},async getDatosParaPdf(a){let{data:d}=await b.apiClient.get(`${c.API_ENDPOINTS.facturas}/${a}/pdf`);return d}},"pagosService",0,{async getAll(a){let{data:d}=await b.apiClient.get(c.API_ENDPOINTS.pagos,a);if(d&&"object"==typeof d&&"success"in d&&d.data){let a=d.data;return Array.isArray(a)?{data:a,total:a.length,current_page:1,last_page:1,per_page:a.length,from:1,to:a.length}:a}return Array.isArray(d)?{data:d,total:d.length,current_page:1,last_page:1,per_page:d.length,from:1,to:d.length}:d},async getById(a){let{data:d}=await b.apiClient.get(`${c.API_ENDPOINTS.pagos}/${a}`);return d},async update(a,d){let{data:e}=await b.apiClient.put(`${c.API_ENDPOINTS.pagos}/${a}`,d);return e},async delete(a){await b.apiClient.delete(`${c.API_ENDPOINTS.pagos}/${a}`)},async verificar(a){let{data:d}=await b.apiClient.post(`${c.API_ENDPOINTS.pagos}/${a}/verificar`);return d},async rechazar(a,d){let{data:e}=await b.apiClient.post(`${c.API_ENDPOINTS.pagos}/${a}/rechazar`,{motivo:d});return e}}])},7370,a=>{"use strict";var b=a.i(57692),c=a.i(98620),d=a.i(28632);a.i(67360);var e=a.i(4656);a.i(95994);var f=a.i(36119),g=a.i(77314),h=a.i(76182),i=a.i(2133),j=a.i(29518),k=a.i(2490);function l(){let a=(0,d.useRouter)(),l=Number((0,d.useParams)().id),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)({numero:"",id_tutor:"",concepto:"",subtotal:"",descuento:"",impuesto:"",fecha_emision:"",fecha_vencimiento:"",observaciones:"",estado:"pendiente"});(0,c.useEffect)(()=>{(async()=>{try{let[a,b]=await Promise.all([j.facturasService.getById(l),k.usuariosService.getAll({per_page:100,rol:"tutor"})]);t(b.data),v({numero:a.numero_factura||"",id_tutor:a.id_tutor?String(a.id_tutor):"",concepto:a.concepto||"",subtotal:String(a.subtotal||""),descuento:a.descuento?String(a.descuento):"",impuesto:a.impuesto?String(a.impuesto):"",fecha_emision:a.fecha_emision||"",fecha_vencimiento:a.fecha_vencimiento||"",observaciones:a.observaciones||"",estado:a.estado||"pendiente"})}catch(a){r("Error al cargar la factura"),console.error(a)}finally{p(!1)}})()},[l]);let w=a=>{let{name:b,value:c}=a.target;v(a=>({...a,[b]:c}))},x=()=>(parseFloat(u.subtotal)||0)-(parseFloat(u.descuento)||0)+(parseFloat(u.impuesto)||0),y=async b=>{b.preventDefault(),n(!0),r("");try{await j.facturasService.update(l,{numero:u.numero,id_tutor:u.id_tutor?parseInt(u.id_tutor):void 0,concepto:u.concepto,subtotal:parseFloat(u.subtotal)||0,descuento:u.descuento?parseFloat(u.descuento):void 0,impuesto:u.impuesto?parseFloat(u.impuesto):void 0,total:x(),fecha_emision:u.fecha_emision,fecha_vencimiento:u.fecha_vencimiento||void 0,observaciones:u.observaciones||void 0,estado:u.estado}),a.push("/finanzas/facturas")}catch(a){r(a instanceof Error?a.message:"Error al actualizar")}finally{n(!1)}};return o?(0,b.jsx)(e.DashboardLayout,{children:(0,b.jsx)("div",{className:"flex justify-center py-12",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):(0,b.jsx)(e.DashboardLayout,{children:(0,b.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{children:"Editar Factura"})}),(0,b.jsxs)(f.CardContent,{children:[q&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:q}),(0,b.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(h.Input,{label:"Número de Factura",name:"numero",value:u.numero,onChange:w,required:!0}),(0,b.jsx)(i.Select,{label:"Cliente (Tutor)",name:"id_tutor",value:u.id_tutor,onChange:w,placeholder:"Seleccionar",options:s.map(a=>({value:a.id_usuario,label:`${a.nombre} ${a.apellido}`}))})]}),(0,b.jsx)(h.Input,{label:"Concepto",name:"concepto",value:u.concepto,onChange:w,required:!0}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsx)(h.Input,{label:"Subtotal ($)",name:"subtotal",type:"number",step:"0.01",value:u.subtotal,onChange:w,required:!0}),(0,b.jsx)(h.Input,{label:"Descuento ($)",name:"descuento",type:"number",step:"0.01",value:u.descuento,onChange:w}),(0,b.jsx)(h.Input,{label:"Impuesto ($)",name:"impuesto",type:"number",step:"0.01",value:u.impuesto,onChange:w})]}),(0,b.jsx)("div",{className:"p-3 bg-gray-100 rounded",children:(0,b.jsxs)("p",{className:"text-lg font-bold",children:["Total: $",x().toFixed(2)]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(h.Input,{label:"Fecha Emisión",name:"fecha_emision",type:"date",value:u.fecha_emision,onChange:w,required:!0}),(0,b.jsx)(h.Input,{label:"Fecha Vencimiento",name:"fecha_vencimiento",type:"date",value:u.fecha_vencimiento,onChange:w})]}),(0,b.jsx)(i.Select,{label:"Estado",name:"estado",value:u.estado,onChange:w,options:[{value:"pendiente",label:"Pendiente"},{value:"pagada",label:"Pagada"},{value:"anulada",label:"Anulada"},{value:"vencida",label:"Vencida"}]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observaciones"}),(0,b.jsx)("textarea",{name:"observaciones",value:u.observaciones,onChange:w,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,b.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,b.jsx)(g.Button,{type:"button",variant:"secondary",onClick:()=>a.back(),children:"Cancelar"}),(0,b.jsx)(g.Button,{type:"submit",disabled:m,children:m?"Guardando...":"Guardar Cambios"})]})]})]})]})})})}a.s(["default",()=>l])}];

//# sourceMappingURL=Documents_GitHub_proyecto-web2-frontend_src_d7ecb7d1._.js.map